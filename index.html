<!DOCTYPE html>
<html lang="ky">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–§–∏—Ä–º–∞ –ú–ü–ê</title>

<style>
body{
margin:0;
font-family:Arial;
background:#0d47a1;
color:white;
}

header{
background:#081c3a;
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logo{
font-size:22px;
font-weight:bold;
color:white;
}

.menu-btn{
font-size:24px;
cursor:pointer;
}

nav{
display:none;
flex-direction:column;
background:white;
color:black;
padding:10px;
}

nav button{
margin:5px 0;
padding:8px;
cursor:pointer;
}

section{
display:none;
padding:15px;
background:white;
color:black;
margin:10px;
border-radius:8px;
}

.active{display:block;}

input,select{
width:100%;
padding:8px;
margin:5px 0;
}

button{
padding:8px;
cursor:pointer;
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
border:1px solid #ccc;
padding:5px;
text-align:center;
}
</style>
</head>

<body>

<header>
<div class="logo">–§–ò–†–ú–ê –ú–ü–ê</div>
<div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
</header>

<nav id="menu">
<button onclick="show('machines')">üöõ –ú–∞—à–∏–Ω–∞–ª–∞—Ä</button>
<button onclick="show('add')">‚õΩ –ê–ª–¥—ã/–°–∞—Ç—Ç—ã</button>
<button onclick="show('report')">üìä –ê–π–ª—ã–∫ –û—Ç—á–µ—Ç</button>
</nav>

<section id="machines" class="active">
<h3>–ú–∞—à–∏–Ω–∞ –∫–æ—à—É—É</h3>
<input type="text" id="carName" placeholder="–ú–∞—à–∏–Ω–∞ –∞—Ç—ã/–Ω–æ–º–µ—Ä–∏">
<button onclick="addMachine()">–ö–æ—à—É—É</button>
<div id="machineList"></div>
</section>

<section id="add">
<h3>–û–ø–µ—Ä–∞—Ü–∏—è</h3>
<select id="machineSelect"></select>
<select id="type">
<option value="buy">–ê–ª–¥—ã</option>
<option value="sell">–°–∞—Ç—Ç—ã</option>
</select>
<input type="number" id="liters" placeholder="–õ–∏—Ç—Ä">
<input type="number" id="price" placeholder="–ë–∞–∞—Å—ã">
<button onclick="addOperation()">–°–∞–∫—Ç–æ–æ</button>
</section>

<section id="report">
<h3>üìÖ –ê–π–ª—ã–∫ –û—Ç—á–µ—Ç</h3>
<div id="monthlyReport"></div>
</section>

<script>

let machines = JSON.parse(localStorage.getItem("machines")) || [];
let operations = JSON.parse(localStorage.getItem("operations")) || [];

function save(){
localStorage.setItem("machines",JSON.stringify(machines));
localStorage.setItem("operations",JSON.stringify(operations));
}

function toggleMenu(){
let m=document.getElementById("menu");
m.style.display = (m.style.display==="flex")?"none":"flex";
}

function show(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function addMachine(){
let name=document.getElementById("carName").value;
if(!name) return;
machines.push({name});
save();
renderMachines();
}

function renderMachines(){
let list=document.getElementById("machineList");
let select=document.getElementById("machineSelect");
list.innerHTML="";
select.innerHTML="";
machines.forEach((m,i)=>{
list.innerHTML+="<div>"+m.name+"</div>";
select.innerHTML+=`<option value="${i}">${m.name}</option>`;
});
}

function addOperation(){
let machine=document.getElementById("machineSelect").value;
let type=document.getElementById("type").value;
let liters=Number(document.getElementById("liters").value);
let price=Number(document.getElementById("price").value);

if(!liters||!price) return;

let date=new Date();
let month=date.getFullYear()+"-"+(date.getMonth()+1);

operations.push({
machine,
type,
liters,
price,
date:date.toLocaleString(),
month
});

save();
alert("–°–∞–∫—Ç–∞–ª–¥—ã!");
renderReport();
}

function renderReport(){
let report=document.getElementById("monthlyReport");
let currentMonth=new Date().getFullYear()+"-"+(new Date().getMonth()+1);

let buy=0,sell=0;

operations.forEach(op=>{
if(op.month===currentMonth){
if(op.type==="buy") buy+=op.liters*op.price;
if(op.type==="sell") sell+=op.liters*op.price;
}
});

report.innerHTML=`
<table>
<tr><th>–ê–π</th><th>–ê–ª–¥—ã</th><th>–°–∞—Ç—Ç—ã</th><th>–ë–∞–ª–∞–Ω—Å</th></tr>
<tr>
<td>${currentMonth}</td>
<td>${buy}</td>
<td>${sell}</td>
<td>${sell-buy}</td>
</tr>
</table>
`;
}

renderMachines();
renderReport();

</script>

</body>
</html>
