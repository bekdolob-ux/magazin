<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–î–∏–∑–µ–ª—å PRO</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial;padding:15px;background:#eef2f7;}
.dark{background:#1e293b;color:white;}
.card{background:white;padding:15px;border-radius:8px;margin-bottom:10px;}
.dark .card{background:#334155;}
input,select,button{width:100%;padding:10px;margin:5px 0;}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #ccc;padding:5px;text-align:center;}
</style>
</head>
<body>

<h2>üõ¢ –î–∏–∑–µ–ª—å PRO</h2>
<button onclick="toggleTheme()">üåô –¢–µ–º–∞</button>

<div class="card">
<h3>–û–ø–µ—Ä–∞—Ü–∏—è</h3>
<select id="type">
<option value="buy">–ê–ª–¥—ã</option>
<option value="sell">–°–∞—Ç—Ç—ã</option>
</select>
<input type="number" id="liters" placeholder="–õ–∏—Ç—Ä">
<input type="number" id="price" placeholder="–ë–∞–∞—Å—ã">
<button onclick="addOperation()">–ö–æ—à—É—É</button>
</div>

<div class="card">
<h3>üí∞ –ë–∞–ª–∞–Ω—Å</h3>
<h2 id="balance">0</h2>
</div>

<div class="card">
<h3>üìä –ì—Ä–∞—Ñ–∏–∫</h3>
<canvas id="chart"></canvas>
</div>

<div class="card">
<h3>üìÑ –û–ø–µ—Ä–∞—Ü–∏—è–ª–∞—Ä</h3>
<table>
<thead>
<tr>
<th>–î–∞—Ç–∞</th>
<th>–¢“Ø—Ä“Ø</th>
<th>–õ–∏—Ç—Ä</th>
<th>–°—É–º–º–∞</th>
<th>‚ùå</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>

<script>

let data=JSON.parse(localStorage.getItem("data"))||[];
let chart;

function save(){
localStorage.setItem("data",JSON.stringify(data));
}

function addOperation(){

let type=document.getElementById("type").value;
let liters=Number(document.getElementById("liters").value);
let price=Number(document.getElementById("price").value);

if(!liters || !price){
alert("–ú–∞–∞–ª—ã–º–∞—Ç —Ç–æ–ª—Ç—É—Ä—É“£—É–∑!");
return;
}

data.push({
type,
liters,
price,
date:new Date().toLocaleString()
});

document.getElementById("liters").value="";
document.getElementById("price").value="";

save();
calculate();
}

function deleteItem(index){
data.splice(index,1);
save();
calculate();
}

function calculate(){

let balance=0;
let buys=0;
let sells=0;

let table=document.getElementById("tableBody");
table.innerHTML="";

data.forEach((o,index)=>{
let total=o.liters*o.price;

if(o.type==="buy"){
balance-=total;
buys+=total;
}
if(o.type==="sell"){
balance+=total;
sells+=total;
}

table.innerHTML+=`
<tr>
<td>${o.date}</td>
<td>${o.type==="buy"?"–ê–ª–¥—ã":"–°–∞—Ç—Ç—ã"}</td>
<td>${o.liters}</td>
<td>${total}</td>
<td><button onclick="deleteItem(${index})">‚ùå</button></td>
</tr>
`;
});

document.getElementById("balance").innerText=balance;

if(chart) chart.destroy();

chart=new Chart(document.getElementById("chart"),{
type:"bar",
data:{
labels:["–ê–ª–¥—ã","–°–∞—Ç—Ç—ã"],
datasets:[{
label:"–°—É–º–º–∞",
data:[buys,sells]
}]
}
});
}

function toggleTheme(){
document.body.classList.toggle("dark");
}

calculate();

</script>

</body>
</html>
